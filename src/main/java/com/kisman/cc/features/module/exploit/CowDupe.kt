package com.kisman.cc.features.module.exploit

import com.kisman.cc.features.module.Category
import com.kisman.cc.features.module.Module
import com.kisman.cc.settings.Setting
import com.kisman.cc.util.chat.cubic.ChatUtility
import net.minecraft.init.Items
import net.minecraft.network.play.client.CPacketUseEntity
import net.minecraft.util.EnumHand

/**
 * @author _kisman_
 * @since 14:21 of 30.06.2022
 */
class CowDupe : Module(
    "CowDupe",
    "Dupes your cows xD",
    Category.EXPLOIT
) {
    private val factor = register(Setting("Factor", this, 150.0, 10.0, 300.0, true))

    override fun onEnable() {
        if(mc.player == null || mc.world == null) {
            super.setToggled(false)
            return
        }

        if (mc.player.inventory.getCurrentItem().getItem() == Items.SHEARS) {
            for (i in 0 until factor.valInt) {
                if (mc.pointedEntity == null) {
                    ChatUtility.error().printClientModuleMessage("Where your cow?!")
                    super.setToggled(false)
                }
                mc.player.connection.sendPacket(CPacketUseEntity(mc.pointedEntity, EnumHand.MAIN_HAND))
            }
            ChatUtility.complete().printClientModuleMessage("You duped ${factor.valInt} cows!")
        } else {
            ChatUtility.error().printClientModuleMessage("You need to hold shears to do the glitch.")
        }

        super.setToggled(false)
    }
}