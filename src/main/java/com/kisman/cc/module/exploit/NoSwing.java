package com.kisman.cc.module.exploit;

import com.kisman.cc.Kisman;
import com.kisman.cc.event.events.PacketEvent;
import com.kisman.cc.module.Category;
import com.kisman.cc.module.Module;
import com.kisman.cc.settings.Setting;
import me.zero.alpine.listener.EventHandler;
import me.zero.alpine.listener.Listener;
import net.minecraft.network.play.client.CPacketAnimation;
import net.minecraft.util.EnumHand;

import java.util.ArrayList;
import java.util.Arrays;

public class NoSwing extends Module {
    private Setting main = new Setting("MainHand", this, true);
    private Setting off = new Setting("OffHand", this, true);

    public NoSwing() {
        super("NoSwing", "", Category.EXPLOIT);

        setmgr.rSetting(main);
        setmgr.rSetting(off);
    }

    public void onEnable() {
        Kisman.EVENT_BUS.subscribe(listener);
    }

    public void onDisable() {
        Kisman.EVENT_BUS.unsubscribe(listener);
    }

    @EventHandler
    private final Listener<PacketEvent.Send> listener = new Listener<>(event -> {
        if(event.getPacket() instanceof CPacketAnimation) {
            CPacketAnimation packet = (CPacketAnimation) event.getPacket();


            if(packet.getHand().equals(EnumHand.MAIN_HAND) && main.getValBoolean()) {
                event.cancel();
            }

            if(packet.getHand().equals(EnumHand.OFF_HAND) && off.getValBoolean()) {
                event.cancel();
            }
        }
    });
}
